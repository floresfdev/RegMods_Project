---
title: Motor Trend car tests - Relationship between type of transmission and fuel
  consumption
author: "Fernando Flores"
date: "January 28th, 2016"
output: word_document
---

```{r setoptions, echo = FALSE, warning = FALSE}
library(knitr)
opts_chunk$set(warning = TRUE, #Make it FALSE for distribution!
               message = TRUE, #Make it FALSE for distribution!
               fig.width = 12,
               fig.height = 6)
```


## Execute Summary

The current report aims to investigate the relationship between the type of transmission and fuel consumption based on data of 32 cars tested by Motor Trend US magazine for an issue published in 1974. The main target is to assess if automatic or manual transmission is better for MPG (miles per US gallon), and quantify the consumption difference for the mentioned transmission types.


## Exploratory Data Analysis

```{r loadData}
library(datasets)
data(mtcars)
```

The basic features of the dataset are summarized in appendix A1. More details can be found in [the documentation online](https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/mtcars.html)

```{r dimData, echo = FALSE}
rowNumber <- nrow(mtcars)
colNumber <- ncol(mtcars)
```

The source dataset has `{r colNumber}` columns of information from `{r rowNumber}` cars. The information contained in some of the variables is needing reformat for the sake of the current analysis. For the specifics of columns `vs` and `am` see [this post in StackOverflow](http://stackoverflow.com/questions/18617174/r-mtcars-dataset-meaning-of-vs-variable)

```{r reformatData}
mtcars$cyl <- as.factor(mtcars$cyl)    ## Number of cylinders
mtcars$gear <- as.factor(mtcars$gear)  ## Number of forward gears
mtcars$carb <- as.factor(mtcars$carb)  ## Number of carburetors
mtcars$vs <- as.factor(mtcars$vs)      ## Straight or V-engine
levels(mtcars$vs) <- c("V-engine", "Straight engine")
mtcars$am <- as.factor(mtcars$am)      ## Transmission
levels(mtcars$am) <- c("Automatic", "Manual")
```

The boxplot of fuel consumption by transmission type can be found in appendix A2. This plot gives helpful information about how well manual and automatic transmission performs regarding MPG for the cars tested, but in order to answer the questions of interest we have to analyze regression models.


## Regression Models

### Primary model

As a first step we fit a primary linear model with Miles/US gallon (variable `mpg`) as outcome and transmission type (variabla `am`) as regressor.

```{r primaryModel}
fitPrimary <- lm(mpg ~ am, data = mtcars)
coeffPrimary <- summary(fitPrimary)$coefficients
coeffPrimary
```

*Figure N. Coefficients summary of the primary model*

In the model, `{r coeffPrimary[1]` is the empirical MPG mean for cars with automatic transmission. For the case of manual transmission, the value of `{r coeffPrimary[2]}` is an additional increase to the mentioned MPG mean.

According to the p-value, which is `{r round(coeffPrimary[8], 4)}` and <0.05, this model is statistically significant.

```{r primaryModelRSquared}
rSquaredPrimary <- summary(fitPrimary)$r.squared
rSquaredPrimary
```

By looking at the R-squared value we can see that the transmission type explains only `{r round(rSquaredPrimary, 2) * 100}`% of the variability in MPG. This value is not good enough for our analysis, so we will have to use nested models to select a better one.


### Secondary Models

After researching general information about the car features described on the dataset, the variables related to fuel consumption in practice are:

- `hp`: Gross horsepower, a unit of measurement of engine power.
- `wt`: Weight (lb/1000).
- `qsec`: 1/4 mile time, which can be a good measure of acceleration by proxy.
- `gear`: Number of forward gears, which is related to transmission.
- `carb`: Number of carburetors, the device in charge of air-fuel mix for better consumption performance.

Besides the transmission type (`am`), this 5 variables are included one by one in nested models to look for a fitted linear model that can explain better the MPG variability.

```{r secondaryModels}
fit2 <- update(fitPrimary, mpg ~ am + hp)
fit3 <- update(fitPrimary, mpg ~ am + hp + wt)
fit4 <- update(fitPrimary, mpg ~ am + hp + wt + qsec)
fit5 <- update(fitPrimary, mpg ~ am + hp + wt + qsec + gear)
fit6 <- update(fitPrimary, mpg ~ am + hp + wt + qsec + gear + carb)

anova(fitPrimary, fit2, fit3, fit4, fit5, fit6)
```

After the analysis of variance, the p-values for models 2 and 3 are statistically significant. Both are also parsimonious so they are good candidates for the definitive model.


### Model selection


## Conclusions

- Is an automatic or manual transmission better for MPG?

- Quantify the MPG difference between automatic and manual transmissions.



## Appendix

### A1. Summary of the data

```{r summaryData}
str(mtcars)
```


### A2. Boxplot of fuel consumption by transmission type

```{r boxplot}
par(mfrow = c(1, 1), mar = c(4, 4, 2, 1))
boxplot(mpg ~ am, data = mtcars,
        col = c("coral", "aquamarine"),
        xlab = "Transmission type",
        ylab = "Miles/US gallon (mpg)",
        main = "Fuel consumption by transmission types")
```

*Figure N. Boxplot of fuel consumption by transmission types*

